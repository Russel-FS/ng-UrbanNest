<!-- multimedia seccion -->
<div class="space-y-6 mx-auto p-6 max-w-6xl">
  <!-- Header -->
  <div class="text-center mb-8">
    <h2 class="text-2xl font-semibold text-gray-800 mb-2">¡Comparte fotos del inmueble!</h2>
    <p class="text-gray-600">
      Carga entre 3 y 10 fotos. Una vez cargadas, arrastra y suelta para cambiarlas de orden.
    </p>
    <p class="text-sm text-gray-500">
      Se admiten los formatos jpg, jpeg y png desde 500 x 500px hasta 6000 x 6000px.
    </p>
  </div>

  <!-- Zona de soltar imagenes -->
  <div
    class="border-2 border-dashed rounded-lg p-8 text-center transition-colors"
    [ngClass]="{
      'border-blue-300 hover:border-blue-500': !isPhotoDragging,
      'border-blue-500': isPhotoDragging
    }"
    (dragover)="onDragOver($event, 'photos')"
    (dragleave)="onDragLeave($event, 'photos')"
    (drop)="onDrop($event, 'photos')"
  >
    <div class="space-y-4">
      <!-- Icon -->
      <div class="flex justify-center">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-12 w-12 text-blue-500"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
          />
        </svg>
      </div>

      <!-- instrucciones de carga -->
      <h3 class="text-lg font-medium text-gray-900">Arrastra o agrega las fotos del inmueble</h3>

      <!-- Input de archivos -->
      <div>
        <input
          #photoInput
          id="photosInput"
          type="file"
          accept="image/jpeg,image/jpg,image/png"
          (change)="onFileSelected($event, 'photos')"
          multiple
          class="hidden"
        />
        <button
          (click)="photoInput.click()"
          class="px-6 py-2 rounded-full text-white transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 bg-blue-600 hover:bg-blue-700 focus:ring-blue-500"
        >
          Seleccionar archivos
        </button>
      </div>
    </div>
  </div>

  <!-- mensajes de error -->
  <div *ngIf="photoErrorMessage" class="text-red-500 text-sm mt-2 text-center">
    {{ photoErrorMessage }}
  </div>

  <!-- Grid de previsualización -->
  <div
    *ngIf="photoPreviews.length > 0"
    class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4 mt-6"
    cdkDropList
    [cdkDropListData]="photoPreviews"
    (cdkDropListDropped)="drop($event, 'photos')"
    cdkDropListGroup
  >
    <div
      *ngFor="let preview of photoPreviews; let i = index"
      class="relative group cursor-move"
      cdkDrag
      [cdkDragData]="preview"
    >
      <div class="relative aspect-square overflow-hidden rounded-lg shadow-md">
        <img
          [src]="preview"
          class="w-full h-full transition-transform group-hover:scale-105 object-cover"
          alt="Photo preview"
        />
        <div
          class="absolute inset-0 bg-black opacity-0 group-hover:opacity-20 transition-opacity"
        ></div>

        <!-- boton de eliminar -->
        <button
          (click)="removeFile(i, 'photos')"
          class="absolute top-2 right-2 p-1.5 bg-red-500 text-white hover:bg-red-600 rounded-full transition-colors cursor-pointer opacity-0 group-hover:opacity-100"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="currentColor"
            class="w-4 h-4"
          >
            <path
              fill-rule="evenodd"
              d="M3.707 3.293a1 1 0 011.414 0L12 10.586l7.879-7.88a1 1 0 111.414 1.414L13.414 12l7.88 7.879a1 1 0 01-1.414 1.414L12 13.414l-7.879 7.88a1 1 0 01-1.414-1.414L10.586 12 2.707 4.121a1 1 0 010-1.414z"
              clip-rule="evenodd"
            ></path>
          </svg>
        </button>
      </div>

      <!-- texto de contador -->
      <div class="text-xs text-gray-500 mt-1 text-center">Foto {{ i + 1 }}</div>
    </div>
  </div>
</div>

<!-- Sección de Planos -->
<div class="space-y-6 mx-auto p-6 max-w-6xl border-t border-gray-200 mt-8 pt-8">
  <!-- Header  -->
  <div class="text-center mb-8">
    <h2 class="text-2xl font-semibold text-gray-800 mb-2">Planos (opcional)</h2>
    <p class="text-gray-600">
      Carga los planos del inmueble. Una vez cargados, arrastra y suelta para cambiarlos de orden.
    </p>
    <p class="text-sm text-gray-500">
      Se admiten los formatos jpg, jpeg y png desde 500 x 500px hasta 6000 x 6000px.
    </p>
  </div>

  <!-- Zona de soltar planos -->
  <div
    class="border-2 border-dashed rounded-lg p-8 text-center transition-colors"
    [ngClass]="isPlanDragging ? 'border-indigo-500' : 'border-indigo-300 hover:border-indigo-500'"
    (dragover)="onDragOver($event, 'plans')"
    (dragleave)="onDragLeave($event, 'plans')"
    (drop)="onDrop($event, 'plans')"
  >
    <div class="space-y-4">
      <!-- Icon -->
      <div class="flex justify-center">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-12 w-12 text-indigo-500"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
          />
        </svg>
      </div>

      <!-- instrucciones de carga -->
      <h3 class="text-lg font-medium text-gray-900">Arrastra o agrega los planos del inmueble</h3>

      <!-- Input File -->
      <div>
        <input
          #planInput
          id="plansInput"
          type="file"
          accept="image/jpeg,image/jpg,image/png"
          (change)="onFileSelected($event, 'plans')"
          multiple
          class="hidden"
        />
        <button
          (click)="planInput.click()"
          class="px-6 py-2 rounded-full text-white transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 bg-indigo-600 hover:bg-indigo-700 focus:ring-indigo-500"
        >
          Seleccionar archivos
        </button>
      </div>
    </div>
  </div>

  <!-- Error  -->
  <div *ngIf="planErrorMessage" class="text-red-500 text-sm mt-2 text-center">
    {{ planErrorMessage }}
  </div>

  <!-- Grid de previsualización -->
  <div
    *ngIf="planPreviews.length > 0"
    class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 mt-6"
    cdkDropList
    [cdkDropListData]="planPreviews"
    (cdkDropListDropped)="drop($event, 'plans')"
    cdkDropListGroup
  >
    <div
      *ngFor="let preview of planPreviews; let i = index"
      class="relative group cursor-move"
      cdkDrag
      [cdkDragData]="preview"
    >
      <div class="relative aspect-square overflow-hidden rounded-lg shadow-md">
        <img
          [src]="preview"
          class="w-full h-full transition-transform group-hover:scale-105 object-contain bg-gray-100"
          alt="Floor plan preview"
        />
        <div
          class="absolute inset-0 bg-black opacity-0 group-hover:opacity-20 transition-opacity"
        ></div>

        <!-- boton de eliminar -->
        <button
          (click)="removeFile(i, 'plans')"
          class="absolute top-2 right-2 p-1.5 bg-red-500 text-white hover:bg-red-600 rounded-full transition-colors cursor-pointer opacity-0 group-hover:opacity-100"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="currentColor"
            class="w-4 h-4"
          >
            <path
              fill-rule="evenodd"
              d="M3.707 3.293a1 1 0 011.414 0L12 10.586l7.879-7.88a1 1 0 111.414 1.414L13.414 12l7.88 7.879a1 1 0 01-1.414 1.414L12 13.414l-7.879 7.88a1 1 0 01-1.414-1.414L10.586 12 2.707 4.121a1 1 0 010-1.414z"
              clip-rule="evenodd"
            ></path>
          </svg>
        </button>
      </div>

      <!-- contador -->
      <div class="text-xs text-gray-500 mt-1 text-center">
        Plano {{ i + 1 }}
        <!-- número de plano -->
      </div>
    </div>
  </div>
</div>
